---
layout:     post
title:      "信用评分卡模型"
subtitle:
date:       2017-1-11 11:00:00
author:     "随机漫步的傻瓜"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
    - 机器学习
---

# 信用评分卡模型

- 企业经营性贷款的常用变量有净资产收益率、总资产利润率、流动比率、速动比率、资产负债率、存货周转率、应收账款周转率、总资产周转率、主营业务收入增长率
- 个人消费类贷款的评估角度：基本属性、偿债能力、信用往来、财务状况、贷款属性、其他因素
- 个人消费类贷款的常用变量：
![个人消费类贷款的常用变量](/img/常用变量.png)

- 信用评分卡的基本原理是用客户“过去的表现预测未来的行为”，需要对模型预测的时间点进行明确的定义，称为时间窗口（Time Windows）。时间窗口中将时间点区分为两部分：“样本窗口”指选择已知好/坏的账户当作开发样本的特定时间段；“表现窗口”是在某个特定时间段内开立的账户的表现被监控并确定类别（目标标量）的时间段。假设某个特定的时间点，一个新账户审批通过并获得授信。在未来的某个时间点，需要确定该账户是正常还是违约（即确定表现）。因为账户的表现需要一定的时间才能达到稳定，开发样本要选择成熟的样本，即给予开发样本足够长的表现时间，使样本总体的坏账率（或违约率）达到稳定。根据经验，中小企业贷款以1年期以内的短期流动资金贷款为主，违约风险的暴露基本在1年到2年之间。因此，建议表现窗口的时间长度为1～2年为宜。但具体要根据不同银行样本数据的实际情况确定。
- 数据来源：人口统计数据、征信数据、交易记录、财务信息、走访获取的信息、其他第三方数据
- 变量的构造和衍生：RFM（Recency（最近一次）/Frequency/Monetary(花费)）、Transaction Interval(Average/Variance/stability)、Momentum(各种比值)
、Relative Spend/Normalized Relative Spend(不同的花费种类组成)
- 极端值的识别：看分布、做聚类
- 连续变量的分箱：能够抓住非线性关系、减少极端值的干扰，更稳健
- 异常值和极端值的处理：如截断，比如大于99的都为99，小于1的都为1；
- 变量之间的相关性：评估自变量之间的关联、评估自变量对目标变量的预测力
![变量之间的相关性](/img/变量之间的相关性.png)

- 斯皮尔曼相关系数只考虑顺序，对极端值不敏感，因此比皮尔逊相关系数更稳健
- 类别变量的降维：合并同类level,合并低频level,依靠决策树算法（做出最优的分组）
- 连续变量的分箱：满足标准评分卡格式的需求、能够抓住非线性关系、减少极端值的干扰，更稳健。分为等宽分箱和等高分箱。可以根据IV删选
- 所谓WOE变换，就是将所有自变量做分箱，然后用每个箱的WOE代替原始变量
- 在数据挖掘中或信用评分中，K-S值的意义：K-S值越大，表示评分模型能够将“好”、“坏”客户区分开来的程度越大。K-S 曲线：将所有申请者的信用评分由小到大排列，分别计算每一个分数之下“好”、“坏”帐户累计所占的百分比，再将这两种累计百分比与评分做在同一张图形上，得到K-S曲线。K-S值：各分数下对应的累计“坏”帐户百分比与累计“好”帐户百分比之差的最大值。
- woe反映的是在自变量每个分组下违约用户对正常用户占比和总体中违约用户对正常用户占比之间的差异；从而可以直观的认为woe蕴含了自变量取值对于目标变量（违约概率）的影响。再加上woe计算形式与logistic回归中目标变量的logistic转换(logist_p=ln(p/1-p))如此相似，因而可以将自变量woe值替代原先的自变量值；
- 其实IV衡量的是某一个变量的信息量，从公式来看的话，相当于是自变量woe值的一个加权求和，其值的大小决定了自变量对于目标变量的影响程度；从另一个角度来看的话，IV公式与信息熵的公式极其相似
- 而且规则引擎和信用评分卡模型分开的模式，有时会因为规则引擎里面某些规则过强而拒绝掉很多优质客户因此比较好的改进方法是，将规则引擎作为一系列弱的分类器，与信用卡评分分类器一块构成强的分类器模型。在这方面，GBDT将是一个不错选择
- K-S用于衡量好坏两个群体分布之间的最大差异，(Sensitivity-Specificity)，KS取值处即为统计意义上的最佳cutoff切点
- ROC曲线的横坐标是FPR，纵坐标是TPR。TPR=TP/(TP+FN);FPR=FP/（FP+TN）
- 多维情况下，如果自变量彼此不相关，则所有系数仍然都应该接近“1”
- 识别极端值：看分布，做聚类
- 连续变量与连续变量：皮尔逊相关系数；类别变量与连续变量：F检验；类别变量与类别变量：卡方检验
- WOE表示的实际上是“当前分组中响应客户占所有响应客户的比例”和“当前分组中没有响应的客户占所有没有响应的客户的比例”的差异。WOE越大，这种差异越大，这个分组里的样本响应的可能性就越大，WOE越小，差异越小，这个分组里的样本响应的可能性就越小
- 对于变量的一个分组，IV是WOE乘以这个分组响应占比和未响应占比的差。体现出了变量当前分组中个体的数量占整体个体数量的比例，对变量预测能力的影响
- 所谓WOE变换，就是将所有自变量做分箱，然后用每个箱的WOE代替原始变量
- 多维情况下，如果自变量彼此不相关，则所有系数仍然都应该接近”1"
- 爆卡指的是本期账单余额大于信用卡额度，用户持卡数；收入支出次数比和收入支出金额比；每个用户的总消费次数；
- woe反映的是在自变量每个分组下违约用户对正常用户占比和总体中违约用户对正常用户占比之间的差异；从而可以直观的认为woe蕴含了自变量取值对于目标变量（违约概率）的影响.我们可以看到IV值其实是woe值加权求和。这个加权主要是消除掉各分组中数量差异带来的误差
- WOE其实描述了变量当前这个分组，对判断个体是否会响应（或者说属于哪个类）所起到影响方向和大小，当WOE为正时，变量当前取值对判断个体是否会响应起到的正向的影响，当WOE为负时，起到了负向影响。而WOE值的大小，则是这个影响的大小的体现
- 一般的线性模型会遇到两个问题：一是非线性特征的学习，比如年龄。一般使用的方法是进行变量离散化，把年龄分成不同的段或者使用稀疏编码或者自编码等算法对品类或者其他信息进行重构。二是交互影响，例如收入特征和年龄特征的交叉。使用Xgboost等模型加工非线性特征，或使用FM/FFM类算法学习交叉特征，以此提升模型拟合能力。
- IV值其实是woe值加权求和。这个加权主要是消除掉各分组中数量差异带来的误差
- 根据每个变量IV值得大小排序取筛选变量，IV越大的越要保留
